<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mgs.dao.PmemberDAO">
	<resultMap id="BaseResultMap" type="com.mgs.entity.Pmember">
		<id column="id" jdbcType="VARCHAR" property="id" />
		<result column="umane" jdbcType="VARCHAR" property="umane" />
		<result column="rmane" jdbcType="VARCHAR" property="rmane" />
		<result column="pword" jdbcType="VARCHAR" property="pword" />
		<result column="isParty" jdbcType="INTEGER" property="isParty" />
		<result column="ctime" jdbcType="TIMESTAMP" property="ctime" />
		<result column="mtime" jdbcType="TIMESTAMP" property="mtime" />
	</resultMap>

	<select id="selectByPrimaryKey" resultType="com.mgs.entity.Pmember">
		SELECT * FROM PMembers WHERE id = #{id}
	</select>

	<select id="selectAllMembers" resultType="com.mgs.entity.Pmember">
		SELECT * FROM PMembers
	</select>

	<select id="selectMembersByuname" resultType="com.mgs.entity.Pmember">
		SELECT * FROM PMembers where uname like '%#{un}%'
	</select>

	<select id="selectMembersByrname" resultType="com.mgs.entity.Pmember">
		SELECT * FROM PMembers where rname like '%#{rn}%'
	</select>

	<update id="updateMemberUname">
		UPDATE PMembers set uname = #{uname} where id = #{id}
	</update>

	<update id="updateMemberPword">
		UPDATE PMembers set pword = #{pword}, mtime = now()
		where id = #{id}
	</update>

	<insert id="addNewMember" parameterType="com.mgs.entity.Pmember">
		<selectKey resultType="java.lang.String" order="AFTER"
			keyProperty="id">
			SELECT LAST_INSERT_ID() AS id
		</selectKey>
		INSERT INTO PMembers (id, uname, rname, pword, isParty, ctime, mtime)
		VALUES (UUID(), #{uname}, #{rname}, #{pword}, #{isParty}, now(),
		now())
	</insert>

</mapper>